; Демонстрация уязвимости переполнения буфера

.ORG 0x100

start:
    ; Инициализируем стек
    LOAD_IMM R0, 0x800
    STORE_REG R0, 0x500    ; Сохраняем адрес возврата в памяти
    
    ; Запись в пределах буфера
    LOAD_IMM R1, 0xAAAAAAAA
    STORE_REG R1, 0x300    ; Запись в начало буфера
    
    ; Переполнение буфера
    LOAD_IMM R2, 0xBBBBBBBB
    STORE_REG R2, 0x310    ; Запись за пределы буфера
    
    ; Демонстрация эксплуатации
    LOAD_IMM R3, 0xDEADC0DE ; Вредоносный код
    STORE_REG R3, 0x500     ; Перезаписываем адрес возврата
    
    ; Переход по адресу из памяти
    LOAD_MEM R4, 0x500
    JMP R4                  ; Здесь произойдет переход по измененному адресу
    
    HALT 